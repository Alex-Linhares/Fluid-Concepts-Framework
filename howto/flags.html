

<!doctype html>


<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>How to add flags to the application &#8212; PySeqsee 0.2.3a1 documentation</title>
    
    <link rel="stylesheet" href="../_static/bizstyle.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '0.2.3a1',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/underscore.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <script type="text/javascript" src="../_static/bizstyle.js"></script>
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="How to create a workspace" href="create_workspace_for_app.html" />
    <link rel="prev" title="Running a set of examples in batch" href="running_in_batch.html" />
    <meta name="viewport" content="width=device-width,initial-scale=1.0">
    <!--[if lt IE 9]>
    <script type="text/javascript" src="_static/css3-mediaqueries.js"></script>
    <![endif]-->
  </head>
  <body role="document">
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="create_workspace_for_app.html" title="How to create a workspace"
             accesskey="N">next</a> |</li>
        <li class="right" >
          <a href="running_in_batch.html" title="Running a set of examples in batch"
             accesskey="P">previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PySeqsee 0.2.3a1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="howto_index.html" accesskey="U">How to ...</a> &#187;</li> 
      </ul>
    </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
            <p class="logo"><a href="../index.html">
              <img class="logo" src="../_static/logo.jpg" alt="Logo"/>
            </a></p>
  <h3><a href="../index.html">Table Of Contents</a></h3>
  <ul>
<li><a class="reference internal" href="#">How to add flags to the application</a><ul>
<li><a class="reference internal" href="#where-the-flags-are-defined">Where the flags are defined</a></li>
<li><a class="reference internal" href="#processing-of-flags">Processing of flags</a></li>
<li><a class="reference internal" href="#the-entry-point-of-apps">The entry point of apps</a></li>
<li><a class="reference internal" href="#where-the-flags-get-stored">Where the flags get stored</a></li>
</ul>
</li>
</ul>

  <h4>Previous topic</h4>
  <p class="topless"><a href="running_in_batch.html"
                        title="previous chapter">Running a set of examples in batch</a></p>
  <h4>Next topic</h4>
  <p class="topless"><a href="create_workspace_for_app.html"
                        title="next chapter">How to create a workspace</a></p>
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <form class="search" action="../search.html" method="get">
      <div><input type="text" name="q" /></div>
      <div><input type="submit" value="Go" /></div>
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <div class="section" id="how-to-add-flags-to-the-application">
<h1>How to add flags to the application<a class="headerlink" href="#how-to-add-flags-to-the-application" title="Permalink to this headline">¶</a></h1>
<p>Flags are processed using argparse, and a limited amount of &#8220;distributed&#8221; flag definition is
supported &#8212; several flags are defined in the core (in farg_flags.py), and each application extends
this by adding its own flags.</p>
<div class="section" id="where-the-flags-are-defined">
<h2>Where the flags are defined<a class="headerlink" href="#where-the-flags-are-defined" title="Permalink to this headline">¶</a></h2>
<p>Core flags are defined in &#8216;farg_flags.py&#8217;, which defines the flags parser called &#8216;core_parser&#8217;. The
entry point for each app extends this. Currently, in Seqsee (run_seqsee.py), we see:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">farg_flags</span>
<span class="n">seqsee_parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="p">[</span><span class="n">farg_flags</span><span class="o">.</span><span class="n">core_parser</span><span class="p">])</span>
<span class="n">seqsee_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--sequence&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="processing-of-flags">
<h2>Processing of flags<a class="headerlink" href="#processing-of-flags" title="Permalink to this headline">¶</a></h2>
<p>Flag values are processed to obtain complex default values (for example, the default value of the
flag &#8216;&#8211;stats_directory&#8217; depends on the value of the flag &#8216;&#8211;persistent_directory&#8217;, as the stats
directory is a subdirectory in that directory.</p>
<p>Sanity checking is also done along with creation of directories as needed.</p>
<p>All this happens in the constructor of the farg.core.main.Main, which get passed in the unprocessed
flags. The entry point of each app is a subclass of Main.</p>
<p>While processing flags, a call is made to ProcessCustomFlags, which the Main class of the app can
define if it wishes to process the flags that it has defined (as Seqsee could have done for the flag
&#8211;sequence).</p>
<p>The processed flags are available as self.flags in the Main class.</p>
</div>
<div class="section" id="the-entry-point-of-apps">
<h2>The entry point of apps<a class="headerlink" href="#the-entry-point-of-apps" title="Permalink to this headline">¶</a></h2>
<p>To summerize, here are the relevant bits of the Seqsee app&#8217;s entry point:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">farg_flags</span>
<span class="kn">from</span> <span class="nn">farg.core.main</span> <span class="k">import</span> <span class="n">Main</span>

<span class="n">seqsee_parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">parents</span><span class="o">=</span><span class="p">[</span><span class="n">farg_flags</span><span class="o">.</span><span class="n">core_parser</span><span class="p">])</span>
<span class="n">seqsee_parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--sequence&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">nargs</span><span class="o">=</span><span class="s1">&#39;*&#39;</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">UnprocessedFlags</span><span class="p">(</span><span class="nb">object</span><span class="p">):</span>
  <span class="k">pass</span>

<span class="n">seqsee_parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">(</span><span class="n">args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">namespace</span><span class="o">=</span><span class="n">UnprocessedFlags</span><span class="p">)</span>
<span class="k">class</span> <span class="nc">SeqseeMain</span><span class="p">(</span><span class="n">Main</span><span class="p">):</span>
   <span class="k">def</span> <span class="nf">ProcessCustomFlags</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
     <span class="c1"># can access self.flags with the core flags already processed</span>
     <span class="k">pass</span>

<span class="k">if</span> <span class="n">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
  <span class="n">SeqseeMain</span><span class="p">(</span><span class="n">UnprocessedFlags</span><span class="p">)</span><span class="o">.</span><span class="n">Run</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="section" id="where-the-flags-get-stored">
<h2>Where the flags get stored<a class="headerlink" href="#where-the-flags-get-stored" title="Permalink to this headline">¶</a></h2>
<p>Flags, after processing, end up both in Main.flags and farg_flags.FargFlags. Other modules will use
this latter route for accessing. A module may say:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">farg_flags</span>
<span class="k">if</span> <span class="n">farg_flags</span><span class="o">.</span><span class="n">FargFlags</span><span class="o">.</span><span class="n">use_stored_ltm</span><span class="p">:</span>
  <span class="n">Do</span> <span class="n">something</span>
</pre></div>
</div>
</div>
</div>


          </div>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="right" >
          <a href="create_workspace_for_app.html" title="How to create a workspace"
             >next</a> |</li>
        <li class="right" >
          <a href="running_in_batch.html" title="Running a set of examples in batch"
             >previous</a> |</li>
        <li class="nav-item nav-item-0"><a href="../index.html">PySeqsee 0.2.3a1 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="howto_index.html" >How to ...</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2011, 2012, Abhijit Mahabal.
      Last updated on Jan 13, 2017.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.5.1.
    </div>
  </body>
</html>